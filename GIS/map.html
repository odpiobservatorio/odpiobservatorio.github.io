<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Toasty-->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <!-- leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/leaflet.path.drag@0.0.6/src/Path.Drag.min.js"></script>


    <!-- librerias de bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">

    <script src="https://kit.fontawesome.com/3d0f9c201e.js" crossorigin="anonymous"></script>


    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Cargar scripts -->
    <link rel="stylesheet" href="../style.css">
    <!-- Cargar la nueva configuración para acdeso a los datos de monitor -->

    <script src="misc.js" async></script>
    <script src="mapGraphics.js" async></script>
    <script src="pivotData.js" async></script>
    <script src="./config/dataquery.js" async></script>
    <script src="./Infografias.js" async></script>

    <!--Versiones nuevs d eadministración de capas-->
    <script src="/GIS/layers_config.js" async></script>
    <script src="/monitor-web/config/lists.js" async></script>
    <script src="/GIS/mod_graphics.js" async></script>
    <script src="./config/console.js" async></script>

    <!--Veriones optimizdas de los procesos-->
    <script src="./GlobalMapGrphics.js" async></script>

    <script defer src="../data-access/dataconfig.js" type="module"></script>
    <script src="../data-access/credentials.js"></script>
</head>
<div id="layerjsdiv"></div>

<header id="headerMap" class="sticky-top">
    <!-- barra de menu de mapas -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary bg-success">
        <div class="container-fluid">
            <a class="navbar-brand text-white" href="#">
                <img src="/img/logo.png" width="40px" height="40px">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <i class="bi bi-list text-white"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item" onclick="cinfigIni_data()">
                        <a class="nav-link active text-white" href="#" data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasConsulta" aria-controls="offcanvasConsulta">
                            <i class="bi bi-binoculars-fill me-2"></i>
                            Consultas
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link active text-white" href="#" data-bs-toggle="offcanvas"
                            data-bs-target="#offCapas" aria-controls="offcanvasCapas">Visor Capas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active text-white" href="#" onclick="showPivotArea(true)">Consolidados</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active text-white" href="#" data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasMarcador" aria-controls="offcanvasMarcador"><i
                                class="bi bi-pin-map-fill me-2"></i>Marcadores</a>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Infografias
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item " href="#" onclick="MostrarLeyendas()">
                                    <i class="bi bi-bookmarks-fill me-2"></i>Ver leyendas
                                </a>
                            </li>

                            <li class="mt-1">
                                <a class="dropdown-item" href="#" onclick="PutLabelFree()">
                                    <i class="bi bi-bookmarks-fill"></i>Poner etiqueta libre
                                </a>

                                <a class="dropdown-item" href="#">
                                    <textarea id="inLabel" class="form-control" rows="1"></textarea>
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item " href="#" onclick="SaveMarks()">
                                    <i class="bi bi-cloud-download me-2"></i>Guardar marcas
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item " href="#" onclick="RemoverLabels()">
                                    <i class="bi bi-trash me-2"></i>Limpiar leyendas
                                </a>
                            </li>


                            <li>
                                <a class="dropdown-item " href="#" data-bs-toggle="offcanvas"
                                    data-bs-target="#offcanvasInfografia" aria-controls="offcanvasRight">
                                    Mas...
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item" onclick="ini_menu_graficos()">
                        <a class="nav-link active text-white" href="#" data-bs-toggle="offcanvas"
                            data-bs-target="#offGraficos">
                            Gráficos
                        </a>
                    </li>
                    <li class="nav-item dropdown text-white">
                        <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Configuración
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#" data-bs-toggle="offcanvas"
                                    data-bs-target="#offcanvasConsola">Consola</a></li>
                        </ul>
                    </li>
                </ul>
                <form class="d-flex m-1">
                    <button class="btn bg-success text-white" onclick="SignOut()">Salir</button>
                </form>
            </div>
        </div>
    </nav>
</header>


<body onload="IniProgram()">

    <div id="map"></div>
    <div id="pivot" hidden="true">
        <div class="bg-secondary" style="width: 100%;">
            <button type="button" class="btn btn-secondary" onclick="showPivotArea(false)">
                <i class="bi bi-arrow-return-left"></i>
            </button>
        </div>
        <div class="m-3">
            <div class="fs-5 fw-bold text-secondary">Consolidados</div>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Número de casos:</div>
                <div class="col" id="val_total_casos"></div>
            </div>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Número de víctimas:</div>
                <div class="col" id="val_total_victimas"></div>
            </div>
            <div class="fs-6 text-info">Datos territoriales</div>
            <hr>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Departamento con mayor número de casos:</div>
                <div class="col" id="val_dep_casos"></div>
            </div>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Departamento con mayor número de víctimas:</div>
                <div class="col" id="val_dep_victimas"></div>
            </div>
            <a class="btn ms-4" data-bs-toggle="collapse" href="#collapseDepartPivot">
                + Ver listas
            </a>
            <div class="collapse" id="collapseDepartPivot">
                <div class="row ms-4">
                    <div class="col-auto fw-bold" style="width: 200px;">Departamento</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Casos</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Porcentaje</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Víctimas</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Porcentaje</div>
                </div>
                <div class="ms-5 mb-2" id="pivot_lis_departamentos">

                </div>
            </div>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Municipio con mayor número de casos:</div>
                <div class="col" id="val_mun_casos"></div>
            </div>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Municipio con mayor número de víctimas:</div>
                <div class="col" id="val_mun_victimas"></div>
            </div>
            <a class="btn ms-4" data-bs-toggle="collapse" href="#collapseMuntPivot">
                + Ver listas
            </a>
            <div class="collapse" id="collapseMuntPivot">
                <div class="row ms-4">
                    <div class="col-auto fw-bold" style="width: 200px;">Municipio</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Casos</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Porcentaje</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Víctimas</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Porcentaje</div>

                </div>
                <div class="ms-5 mb-2" id="pivot_lis_municipios">

                </div>
            </div>
            <div class="fs-6 text-secondary text-info">Datos por tendencia</div>
            <hr>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Macrotipo con mayor número de casos:</div>
                <div class="col" id="val_macrotipo_casos"></div>
            </div>
            <div class="row ms-1">
                <div class="col-auto fw-bold text-bg-secondary">Macrotipo con mayor número de víctimas:</div>
                <div class="col" id="val_macrotipo_victimas"></div>
            </div>
            <a class="btn ms-4" data-bs-toggle="collapse" href="#collapsemacrotipoPivot">
                + Ver listas
            </a>
            <div class="collapse" id="collapsemacrotipoPivot">
                <div class="row ms-4">
                    <div class="col-auto fw-bold" style="width: 200px;">Tipo</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Casos</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Porcentaje</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Víctimas</div>
                    <div class="col-auto fw-bold" style="width: 100px;">Porcentaje</div>

                </div>
                <div class="ms-5 mb-2" id="pivot_lis_macrotipo">

                </div>
            </div>
            <hr>
            <div class="fs-6 text-secondary text-info">Datos según resultados</div>
            <div class="row ms-2">
                <div class="col-auto fw-bold" style="width: 200px;">Contexto de búsqueda:</div>
                <div class="col-auto" id="col_contexto"></div>
            </div>
            <div class="row ms-2">
                <div class="col-auto fw-bold" style="width: 200px;">Número de casos:</div>
                <div class="col-auto" style="width: 200px;" id="col_res_casos"></div>
            </div>
            <div class="row ms-2">
                <div class="col-auto fw-bold" style="width: 200px;">Número de víctimas:</div>
                <div class="col-auto" style="width: 200px;" id="col_res_victimas"></div>
            </div>
            <a class="btn ms-2" data-bs-toggle="collapse" href="#collapse_resultados">
                + Ver listas
            </a>
            <div class="collapse" id="collapse_resultados">
                <div class="ms-5 mb-2" id="pivot_lis_resultados">

                </div>
            </div>

        </div>

    </div>
</body>

<!-- Modal new de caso -->
<div class="modal shadow rounded" tabindex="-1" id="ModalCaseOnMap" data-bs-backdrop="static" style="z-index: 1900">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="tlTipoCaso">Caso Número</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" spellcheck="true">
                <div class="h3" id="txTipo"></div>
                <div class="h4 text-primary" id="txAño"></div>
                <div class="h5 text-primary" id="txLugar"></div>
                <div class="h5 text-success" id="txEtnia"></div>
                <div class="h6 text-danger" id="txPerpetuador"></div>
                <p id="txCaso">Modal body text goes here.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal resultado consulta New -->
<div class="modal shadow rounded" tabindex="-1" id="modalconsultacaso" data-bs-backdrop="static" style="z-index: 1900">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header bg-warning">
                <span id="spanvigencia" class="badge bg-secondary rounded-pill fs-6 me-2"></span>
                <h5 class="modal-title text-white" id="tl_index_caso">Caso Número</h5>

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" spellcheck="true" id="body_consolta_caso">
                <div class="fw-bold fs-6 text-success" id="consulta_macroregion"></div>
                <div class="fw-bold fs-6 text-secondary ms-2" id="consulta_departamento"></div>
                <small class="ms-3 fw-bold">Lugares involucrados</small>
                <div class="d-flex flex-wrap ms-3" id="consulta_lugares"></div>
                <div class="fw-bold fs-6 text-primary ms-2" id="consulta_macrotipo"></div>
                <small class="ms-3 fw-bold">Lista de otras afectaciones</small>
                <div class="d-flex flex-wrap ms-3" id="consulta_tipos"></div>
                <small class="ms-3 fw-bold">Descripción del caso</small>
                <div class="ms-4 p-2 border border-1 bg-body-tertiary" id="consulta_detalle"
                    style="text-align: justify;"></div>
                <small class="ms-3 fw-bold">Pueblos involucrados</small>
                <div class="d-flex flex-wrap ms-3" id="consulta_pueblos"></div>
                <div class="fw-bold fs-6 text-secondary ms-2" id="consulta_macroactor"></div>
                <small class="ms-3 fw-bold">Actores involucrados</small>
                <div class="d-flex flex-wrap ms-3" id="consulta_actores"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!--New panel consultas-->
<div class="offcanvas offcanvas-start shadow" tabindex="-1" id="offcanvasConsulta" data-bs-scroll="true"
    data-bs-backdrop="false">
    <div class="offcanvas-header bg-success">
        <h5 class="offcanvas-title text-white" id="offcanvasConsultaLabel">Panel de consultas</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <div class="row align-items-center">
            <!--Botones de configuración de búsqueda-->
            <div class="input-group">
                <div class="dropdown">
                    <div class="btn-group mb-2" role="group" aria-label="Basic example">
                        <button class="btn dropdown-toggle text-white" type="button" data-bs-toggle="dropdown"
                            style="background-color: green;" aria-expanded="false"
                            onclick="ListColors('color-mark-consulta','ulColorMarcaConsulta')" id="btnColor_consulta">
                            <i class="bi bi-brush" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-custom-class="tooltip" data-bs-title="Color marca"></i>
                        </button>
                        <button class="btn dropdown-toggle bg-secondary text-white" type="button"
                            data-bs-toggle="dropdown"
                            onclick="ListColors('colorline-mark-consulta','ulColorMarcaConsulta')">
                            <i class="bi bi-circle" data-bs-toggle="tooltip" data-bs-placement="top"
                                id="btnColorlinea_consulta" data-bs-custom-class="tooltip" data-bs-title="Color linea"
                                style="color: white;"></i>
                        </button>
                        <ul class="dropdown-menu">
                            <div id="ulColorMarcaConsulta" class="container-fluid"></div>
                        </ul>
                        <select class="btn btn-secondary text-white text-start" style="width: 85px;"
                            data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="tooltip"
                            data-bs-title="Opacidad marca" onchange="opacidad_marca_busqueda=this.value">
                            <option value="1">100%</option>
                            <option value="0.9">90%</option>
                            <option value="0.8">80%</option>
                            <option value="0.7">70%</option>
                            <option value="0.6">60%</option>
                            <option value="0.5">50%</option>
                            <option value="0.4">40%</option>
                            <option value="0.3">30%</option>
                            <option value="0.2">20%</option>
                            <option value="0.1">10%</option>
                        </select>
                        <select class="btn btn-secondary text-white text-start" style="width: 85px;"
                            data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="tooltip"
                            data-bs-title="Tamaño marca" onchange="size_marca_busqueda=this.value">
                            <option value="1">1pt</option>
                            <option value="2">2pt</option>
                            <option value="3">3pt</option>
                            <option value="4">4pt</option>
                            <option value="5">5pt</option>
                            <option value="5">6pt</option>
                            <option value="7">7pt</option>
                            <option value="8">8pt</option>
                            <option value="9">9pt</option>
                            <option value="10">10pt</option>
                            <option value="15">15pt</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="input-group">
                <div class="dropdown">
                    <div class="btn-group mb-2" role="group" aria-label="Basic example">
                        <button type="button" class="btn btn-secondary" onclick="limpiar_todo_marcas()"
                            data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="tooltip"
                            data-bs-title="Limpiar marcas">
                            <i class="bi bi-x-circle"></i>
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="ver_todo()">
                            <i class="bi bi-list-ul" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-custom-class="tooltip" data-bs-title="Ver todas las marcas"></i>
                        </button>
                        <button type="button" class="btn btn-secondary" data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasResultadosNew">
                            <i class="bi  bi-view-list"></i>
                        </button>
                        <button id="btnConsulta" type="button" class="btn btn-secondary">
                            <i class="bi bi-binoculars"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!--Lista de campos globales de búsqueda-->
        <small>Lista de campos</small>
        <select id="lstCampos" class="form-select mt-2 mb-2" onchange="crear_listas(this.value)">
            <option value="clsCasos_macroregion">Macroregion</option>
            <option value="clsCasos_departamento">Departamento</option>
            <option value="clsLugares_municipio">Lugar</option>
            <option value="clsPueblos_nombre">Pueblo, Etnia</option>
            <option value="clsCasos_macrotipo">Macrotipo</option>
            <option value="clsTipos_nombre">Subtipo</option>
            <option value="clsCasos_fecha">Fecha</option>
            <option value="clsCasos_vigencia">Año</option>
            <option value="clsPersonas_genero">Género</option>
            <option value="clsCasos_detalle">Detalle</option>
            <option value="clsPersonas_nombres">Personas</option>
            <option value="clsCasos_macroactor">Macro actor</option>
            <option value="clsActores_nombre">Otros actores</option>
            <option value="clsDesplazamiento_tipo">Tipo de desplazamiento</option>
            <option value="clsCasos_npersonas">Numero Personas</option>
            <option value="clsCasos_nmujeres">Numero Mujeres</option>
            <option value="clsCasos_nhombres">Numero Hombres</option>
            <option value="clsCasos_nmenores">Numero Menores</option>
            <option value="clsPersonas_edad">Edad</option>
        </select>
        <!--Lista de operadores-->
        <small>Lista de operadores</small>
        <select id="lstOperadores" class="form-select mt-2 mb-2" onchange="">
            <option value="==">Igual a</option>
            <option value="!==">Diferente a</option>
            <option value=".includes">Similar a</option>
            <option value=">">Mayor a</option>
            <option value=">=">Mayor e igual a</option>
            <option value=&lt>Menor a</option>
            <option value="&lt=">Menor e igual a</option>
        </select>
        <!--Lista de criterios de búsqueda-->
        <small>Lista de criterios</small>
        <div class="dropdown w-100 mt-2 mb-2">
            <button class="btn dropdown-toggle border border-2" type="button" data-bs-toggle="dropdown"
                aria-expanded="false" style="width: 100%;" id="btnCriterios">
                Criterios
            </button>
            <ul class="dropdown-menu menu-group-scroll border border-1 border-success shadow" style="width: 100%;">
                <div class="p-3">
                    <small class="fw-bold">Criterio libre</small>
                    <input type="text" class="form-control form-select-sm" id="intValor_buscar">
                </div>
                <div id="contenedor_criterios">

                </div>

            </ul>
        </div>

        <!--Entrada de criterio abierto-->
        <small>Criterio abierto</small>
        <input type="text" class="form-control" id="intOpentCriterio">
        <hr>
        <div class="dropdown">
            <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-secondary fw-bold" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasConsola">
                    {*}
                </button>
                <button type="button" class="btn btn-secondary fw-bold" onclick="add_criterio_extendido()"
                    data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="tooltip"
                    data-bs-title="Agregar criterio" id="btnAddCriterio">
                    <i class="bi bi-file-earmark-plus"></i>
                </button>
                <button type="button" class="btn btn-secondary" data-bs-toggle="tooltip" id="btnfilter_extend"
                    data-bs-placement="top" data-bs-custom-class="tooltip" data-bs-title="Buscar"
                    onclick="filter_extend()">
                    <i class="bi bi-binoculars"></i>
                </button>

                <button type="button" class="btn btn-secondary" onclick="LimpiarConsulta()" data-bs-toggle="tooltip"
                    data-bs-placement="top" data-bs-custom-class="tooltip" data-bs-title="Limpiar consulta">
                    <i class="bi bi-eraser-fill"></i>
                </button>
            </div>
        </div>
        <ul class="list-group" id="listconsultaextendida">

        </ul>
        <!-- Mapas de calor-->
        <hr>
        <div class="mt-3">
            <div class="row align-items-center">
                <div class="col-auto ms-3">
                    <i class="bi bi-gear-fill" style="color:#CEECF5;" data-bs-toggle="collapse"
                        data-bs-target="#collapsedepcasoscalor" aria-expanded="true"
                        onclick="config_formatcalor('depcasoscalor')"></i>
                </div>
                <div class="col">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="depcasoscalor"
                            onchange="ver_calor_dep(this.checked,this.id)">
                        <label class="form-check-label" for="flexCheckDefault">
                            Porcentaje casos por departamentos
                        </label>
                    </div>
                </div>
            </div>
            <div id="collapsedepcasoscalor" class="accordion-collapse collapse">
            </div>
        </div>
        <div class="mt-3">
            <div class="row align-items-center">
                <div class="col-auto ms-3">
                    <i class="bi bi-gear-fill" style="color:#CEECF5;" data-bs-toggle="collapse"
                        data-bs-target="#collapsedepvictimascalor" aria-expanded="true"
                        onclick="config_formatcalor('depvictimascalor')"></i>
                </div>
                <div class="col">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="depvictimascalor"
                            onchange="ver_calor_dep_victimas(this.checked,this.id)">
                        <label class="form-check-label" for="flexCheckDefault">
                            Porcentaje victimas por departamentos
                        </label>
                    </div>
                </div>
            </div>
            <div id="collapsedepvictimascalor" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            </div>
        </div>
        <div class="mt-3">
            <div class="row align-items-center">
                <div class="col-auto ms-3">
                    <i class="bi bi-gear-fill" style="color:#CEECF5;" data-bs-toggle="collapse"
                        data-bs-target="#collapsemuncasoscalor" aria-expanded="true"
                        onclick="config_formatcalor('muncasoscalor')"></i>
                </div>
                <div class="col">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="muncasoscalor"
                            onchange="ver_calor_mun(this.checked,this.id)">
                        <label class="form-check-label" for="flexCheckDefault">
                            Porcentaje casos por municipios
                        </label>
                    </div>
                </div>
            </div>
            <div id="collapsemuncasoscalor" class="accordion-collapse collapse">

            </div>
        </div>
        <div class="mt-3">
            <div class="row align-items-center">
                <div class="col-auto ms-3">
                    <i class="bi bi-gear-fill" style="color:#CEECF5;" data-bs-toggle="collapse"
                        data-bs-target="#collapsemunvictimascalor" aria-expanded="true"
                        onclick="config_formatcalor('munvictimascalor')"></i>
                </div>
                <div class="col">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="munvictimascalor"
                            onchange="ver_calor_mun_victimas(this.checked,this.id)">
                        <label class="form-check-label" for="flexCheckDefault">
                            Porcentaje víctimas por municipios
                        </label>
                    </div>
                </div>
            </div>
            <div id="collapsemunvictimascalor" class="accordion-collapse collapse">

            </div>
        </div>
    </div>
</div>
<!--New panel consolo log-->
<div class="offcanvas offcanvas-bottom shadow" tabindex="-1" id="offcanvasConsola" data-bs-scroll="true"
    data-bs-backdrop="false" style="height: 250px;">
    <div class="row bg-dark align-items-center p-2">
        <div class="col-auto">
            <div class="btn-group bg-dark" role="group" aria-label="Basic example">
                <button type="button" class="btn text-white" data-bs-dismiss="offcanvas">X</button>
                <select class="form-select form-select-sm bg-dark text-white" aria-label="Small select example"
                    onchange="consola_newLine(this.value)">
                    <option value=0>Limpiar filtro</option>
                    <option value=1>Filto</option>
                    <option value=2>Filtro extendido</option>
                </select>
                <button type="button" class="btn text-white" onclick="consola_clear()">Limpiar</button>
                <button type="button" class="btn text-white" onclick="consola_newLine(0)">Agregar</button>
            </div>
        </div>
        <div class="bg-dark consola-scroll mt-2" id="console-lines">


        </div>
    </div>
    <!-- Panel de marcadores new-->
    <div class="offcanvas offcanvas-end" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1"
        id="offcanvasMarcador" aria-labelledby="offcanvasMarcadorLabel">
        <div class="offcanvas-header bg-success text-white">
            <h5 class="offcanvas-title" id="offcanvasMarcadorLabel">Panel marcadores libres</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
        </div>

        <div class="offcanvas-body">
            <div class="accordion" id="accordionExample">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            Configuración
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                        <div class="accordion-body">

                            <ol class=" list-group list-group-numbered">
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div class="ms-2 me-auto">
                                        <div class="fw-bold">Tipo de marcador</div>
                                        <!--Selector de tipo marcador-->
                                        <div class="input-group mb-3" style="width: 230px;">
                                            <select class="form-select" aria-label="Default select example"
                                                id="sel-tipo-marca" onchange="Change_icon(this)">
                                                <option selected value="0">Círculo</option>
                                                <option value="1">Cuadro</option>
                                            </select>
                                        </div>
                                    </div>
                                    <span class="badge text-bg-primary rounded-pill">
                                        <i class="bi bi-circle-fill text-secondary fs-3" id="ico-Tipo-Marca"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div class="ms-2 me-auto">
                                        <div class="fw-bold">Color del marcador</div>
                                        <!--Selector de colores-->
                                        <div class="dropdown mb-2 border border-1 w-100">
                                            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"
                                                aria-expanded="false"
                                                onclick="ListColors('color-mark-custom','ulColorMarcaPersonalizada')"
                                                style="width: 230px;">
                                                Color
                                            </button>
                                            <ul class="dropdown-menu">
                                                <div id="ulColorMarcaPersonalizada" class="container-fluid"></div>
                                            </ul>
                                        </div>
                                    </div>
                                    <span class="badge rounded-pill p-2 text-black" style="background-color: black;"
                                        id="span-color-marca">color</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div class="ms-2 me-auto">
                                        <div class="fw-bold">Tamaño del marcador</div>
                                        <!--Lista de tamaño del marcador-->
                                        <div class="dropdown border border-1">
                                            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"
                                                aria-expanded="false" style="width: 230px;">
                                                Tamaño
                                            </button>
                                            <ul class="dropdown-menu" style="width: 50px;">
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(5)">0.5x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(7)">0.7x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(8)">0.8x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(10)">1x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(15)">1.5x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(20)">2x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(25)">2.5x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(30)">3x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(35)">3.5x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(40)">4x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(45)">5x</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_size_custom(50)">6x</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <span class="badge rounded-pill p-2 text-dark fs-5" id="span-size-marca">0.5x</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div class="ms-2 me-auto">
                                        <div class="fw-bold">Opacidad del marcador</div>
                                        <!--Lista de tamaño del marcador-->
                                        <div class="dropdown border border-1">
                                            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"
                                                aria-expanded="false" style="width: 230px;">
                                                Opacidad
                                            </button>
                                            <ul class="dropdown-menu" style="width: 50px;">
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(1)">0%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.9)">10%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.8)">20%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.7)">30%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.6)">40%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.5)">50%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.4)">60%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.3)">70%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.2)">80%</a></li>
                                                <li><a class="dropdown-item" href="#"
                                                        onclick="Change_opacity_custom(0.1)">90%</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <span class="badge rounded-pill p-2 text-white" style="background-color: black;"
                                        id="span-opacity-marca">0%</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div class="ms-2 me-auto">
                                        <div class="fw-bold" data-bs-toggle="collapse" href="#collapseCoord"
                                            role="button" aria-expanded="false" aria-controls="collapseCoord">
                                            Coordenadas</div>
                                        <!--Lista de tamaño del marcador-->

                                        <div class="collapse" id="collapseCoord">
                                            Insertar marca formato (5.30, -76.60)
                                            <input id="int_coord-custom" type="text" class="form-control mt-1"
                                                placeholder="coordenadas" aria-label="Coordenadas"
                                                aria-describedby="basic-addon1" style="width: 230px;"
                                                value="4.797, -74.030" oninput="{coordenada_activa=(this.value)}"">
                                  </div>
                                </div>
                            </li>
                            <li class=" list-group-item d-flex justify-content-between align-items-start">
                                            <div class="ms-2 me-auto">
                                                <div class="fw-bold" data-bs-toggle="collapse" href="#collapseInfo"
                                                    role="button" aria-expanded="false" aria-controls="collapseInfo">
                                                    Informacion</div>
                                                <!--Lista de tamaño del marcador-->

                                                <div class="collapse" id="collapseInfo">
                                                    Insertar texto del marcador
                                                    <input id="int_coord-custom" type="text" class="form-control mt-1"
                                                        placeholder="texto" aria-label="Coordenadas"
                                                        aria-describedby="basic-addon1" style="width: 230px;"
                                                        oninput="{formatActivo.texto=(this.value)}">
                                                </div>
                                            </div>
                                </li>

                            </ol>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            Marcadores
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                        <div class="ms-3">
                            <button type="button" class="btn btn-secondary m-2" onclick="show_legens()">
                                <i class="bi bi-tags me-2"></i>
                                Mostrar
                            </button>
                            <button type="button" class="btn btn-secondary m-2" onclick="DeleteMarks()">
                                <i class="bi bi-bookmark-x-fill"></i>
                                Eliminar
                            </button>

                        </div>
                        <div class="accordion-body">
                            <ol class="list-group list-group-numbered" id="list_marcas-custom">

                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <div class="btn-group mt-5 w-100" role="group" aria-label="Basic example"
                style="background-color: azure; font-size: 10pt;">
                <button type="button" class="btn btn-success" onclick="Insertar_marcador_personalizado()">
                    <i class="bi bi-geo-fill"></i></button>

                <button type="button" class="btn btn-success" onclick="copy_format_custom()">
                    <i class="bi bi-c-circle-fill"></i>
                </button>
                <button type="button" class="btn btn-success" onclick="paste_format_custom()">
                    <i class="bi bi-clipboard-check"></i>
                </button>
                <button type="button" class="btn btn-success" onclick="update_format_custom()">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
                <button type="button" class="btn btn-success" onclick="delete_all_custom_marks(1)"><i
                        class="bi bi-file-x"></i></button>
                <button type="button" class="btn btn-success" onclick="delete_all_custom_marks(0)"><i
                        class="bi bi-trash3"></i></button>
                <button type="button" class="btn btn-success" onclick="save_load_custom_marks(0)"><i
                        class="bi bi-download"></i></button>
                <button type="button" class="btn btn-success">
                    <label for="file-input-marks" href="">
                        <i class="bi bi-upload"></i>
                    </label>
                </button>
            </div>
            <input id="file-input-marks" style="visibility:hidden; width: 50px;" type="file" accept=".json">
        </div>


    </div>
    <!-- Panel de infografias-->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasInfografia" aria-labelledby="offcanvasInfografia">
        <div class="offcanvas-header bg-success text-white">
            <h5 class="offcanvas-title" id="offcanvasRightLabel">Infografias avanzado</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div>
                <button type="button" class="btn btn-outline-success" style="width: 80%;">
                    <label for="file-load" class="">
                        <i class="bi bi-cloud-arrow-up-fill me-2"></i>Subir archivos a la nube
                    </label>
                    <input id="file-load" style="visibility:hidden; width: 50px;" type="file" multiple
                        accept=".json, .geojson, .txt">
                </button>
                <div>
                    <button type="button" class="btn btn-outline-success mt-2" style="width: 80%;"
                        onclick="GLOBAL.firestore.ListFilesFirebase()">
                        <i class="bi bi-cloud-arrow-down-fill me-2"></i>
                        Ver archivos de la nube
                    </button>
                </div>
                <div class="mt-2" style="width: 80%;">
                    <ul class="list-group list-group-scroll" id="selPathFiles">

                    </ul>
                </div>

            </div>
        </div>
    </div>

    <!-- llama a los eventos .js para esta página -->

    <script>
        const TileLayerA = {
            openstreetmap: "http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
            opentopomap: "https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",
            stadiamaps: "https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png",
        }
        let map;


        map = L.map("map", {
            zoomDelta: 0.25,
            zoomSnap: 0
        }).setView([5.1, -75.55], 5);


        let ActiveTile;

        async function IniProgram() {
            loadlayers()
            try {
                L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
                    // Y un mapa con un límite de zoom.
                    maxZoom: 19,
                    //attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
                }).addTo(map);
                //Carga las listas para búsqueda
                CargarlstMap()

            } catch (error) {
                console.log("Error en la función ini")
            }

        }
        try {
            //Crea una capa en el mapa para colocar los marcadores tipo poligono, pero los deja siempre arriba.  
            map.createPane('1');
            //New panes to layer
            map.getPane('1').style.zIndex = 400;
            //Crea una capa en el mapa para colocar el mapa croquis.
            map.createPane('2');
            map.getPane('2').style.zIndex = 600;

            map.createPane('3');
            map.getPane('3').style.zIndex = 800;

            map.createPane('4');
            map.getPane('4').style.zIndex = 900;

            map.createPane('5');
            map.getPane('5').style.zIndex = 1100;

            map.createPane('6');
            map.getPane('6').style.zIndex = 1300;

            map.createPane('7');
            map.getPane('7').style.zIndex = 1500;

            map.createPane('labels');
            map.getPane('labels').style.zIndex = 2000;

            map.createPane('polygonsPane');
            map.getPane('polygonsPane').style.zIndex = 1500;



        } catch (error) {

        }
    </script>
    <!-- new panel canvas to list layers -->
    <div class="offcanvas offcanvas-start shadow" tabindex="-1" id="offCapas" data-bs-scroll="true"
        data-bs-backdrop="false">
        <div class="offcanvas-header bg-primary">
            <h5 class="offcanvas-title text-white" id="offcanvasCapasLabel">Panel capas</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="btn-group w-100" role="group" aria-label="Basic example" hidden="true">
                <button type="button" class="btn btn-secondary">
                    <label for="file-input-layers">
                        <i class="bi bi-folder2-open"></i>
                    </label>
                </button>
                <button type="button" class="btn btn-secondary" onclick="">
                    <i class="bi bi-download"></i>
                </button>
            </div>
            <div id="panel_control_layers">

            </div>

        </div>
    </div>
    <!-- New Panel de resultados -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasResultadosNew">
        <div class="offcanvas-header bg-success text-white">
            <div class="row">
                <h5 class="offcanvas-title" id="tlResultados">Resultados</h5>
            </div>
            <button type="button" class="text-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>

        </div>
        <div class="offcanvas-body">
            <div>
                <div class="list-group list-group-numbered" id="lstResGisNew">


                </div>
            </div>
        </div>
    </div>
    <!-- new panel graficos -->
    <div class="offcanvas offcanvas-end shadow" tabindex="-1" id="offGraficos" data-bs-scroll="true"
        data-bs-backdrop="false">
        <div class="offcanvas-header bg-secondary">
            <h5 class="offcanvas-title text-white" id="offcanvasCapasLabel">Panel gráficos</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"
                aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="accordion-item p-1">
                <h2 class="accordion-header">
                    <button class="accordion-button mb-2" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseLineas" aria-expanded="true" aria-controls="collapseOne">
                        Líneas / Rutas
                    </button>
                </h2>
                <div id="collapseLineas" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                    <div class="row m-1">
                        <div class="col"><small>Departamento</small>
                            <select class="form-select form-select-sm ms-1" id="lisDep_graficos">
                            </select>
                        </div>
                        <div class="col">
                            <small>Municipio</small>
                            <select class="form-select form-select-sm ms-1" id="lisMun_graficos">
                            </select>
                        </div>
                    </div>

                    <div class="row m-1">
                        <div class="col">
                            <small>Otro lugar</small>
                            <input type="text" class="form-control ms-1" placeholder="" id="intOtroLugar">
                        </div>
                        <div class="col">
                            <small>Coordenadas</small>
                            <input type="text" class="form-control ms-1" placeholder="0.0,0.0" id="intCoordGrafico">
                        </div>
                    </div>

                    <small>Información</small>
                    <textarea class="form-control" aria-label="With textarea" id="intInfoLine" rows="2"></textarea>
                    <small>Lineas</small>
                    <div>
                        <div class="btn-group mt-1" role="group" aria-label="Basic example" style="width: 100%;">
                            <button id="btnColorLine_graficos" class="btn dropdown-toggle bg-secondary text-white"
                                type=" button" data-bs-toggle="dropdown">
                                <i id="iclg" class="bi bg-white p-1 fw-bold" data-bs-toggle="tooltip"
                                    data-bs-placement="top" id="btnColorlinea_consulta" data-bs-custom-class="tooltip"
                                    data-bs-title="Color linea" style="color: black;">——</i>
                            </button>
                            <ul class="dropdown-menu">
                                <div id="ulColorLinea_graficos" class="container-fluid">

                                </div>
                            </ul>
                            <select id="selOpacityLine_graficos" class="btn btn-secondary text-white text-start"
                                style="width: 85px;" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-custom-class="tooltip" data-bs-title="Opacidad linea">
                                <option value="1">100%</option>
                                <option value="0.9">90%</option>
                                <option value="0.8">80%</option>
                                <option value="0.7">70%</option>
                                <option value="0.6">60%</option>
                                <option value="0.5">50%</option>
                                <option value="0.4">40%</option>
                                <option value="0.3">30%</option>
                                <option value="0.2">20%</option>
                                <option value="0.1">10%</option>
                            </select>
                            <select id="selGrosorLine_graficos" class="btn btn-secondary text-white text-start"
                                style="width: 70px;" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-custom-class="tooltip" data-bs-title="Grosor linea">
                                <option value="1">1pt</option>
                                <option value="2">2pt</option>
                                <option value="3">3pt</option>
                                <option value="4">4pt</option>
                                <option value="5">5pt</option>
                                <option value="5">6pt</option>
                                <option value="7">7pt</option>
                                <option value="8">8pt</option>
                                <option value="9">9pt</option>
                                <option value="10">10pt</option>
                                <option value="15">15pt</option>
                            </select>
                            <select id="selTipoLine_graficos" class="btn btn-secondary text-white text-start"
                                style="width:90px;" data-bs-toggle="tooltip" data-bs-placement="top"
                                data-bs-custom-class="tooltip" data-bs-title="Tipo de linea">

                                <option value=0> —— </option>
                                <option value=5,5> ------ </option>
                                <option value=5,10> - - - - </option>
                                <option value=10,5> – – – </option>
                                <option value=1> ∙ ∙ ∙ ∙ ∙ </option>
                            </select>
                        </div>
                        <div class="btn-group mt-1" role="group" aria-label="Basic example" style="width: 100%;">
                            <button type="button" class="btn btn-secondary" id="line_ini_point">
                                <i class="bi bi-align-start"></i>
                            </button>
                            <button type="button" class="btn btn-secondary" id="line_end_point">
                                <i class="bi bi-align-end"></i>
                            </button>

                            <button type="button" class="btn btn-secondary" onclick="clear_line()">
                                Limpiar
                            </button>
                            <button type="button" class="btn btn-secondary" id="btnSave_line">
                                <i class="bi bi-download"></i>
                            </button>
                            <button for="file-input-marks" type="button" class="btn btn-secondary" id="btnLoad_line">
                                <label for="file-input-lines" href="">
                                    <i class="bi bi-upload"></i>
                                </label>
                            </button>
                        </div>
                        <input id="file-input-lines" style="visibility:hidden; width: 50px;" type="file" accept=".json">
                    </div>
                </div>
                <ol class="list-group list-group-numbered" id="panel_lista_lines">

                </ol>

            </div>
        </div>

    </div>
</div>

</html>